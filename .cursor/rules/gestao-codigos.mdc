---
description: Gestão de Códigos (admin) – lista paginada 50 itens, busca por código ou IP, status, exportação CSV
globs: src/components/views/AdminView.tsx,**/admin/**/*.tsx,src/hooks/useAdmin.ts,src/services/api/admin.ts,api/routes/admin.ts,api/services/codeService.ts
alwaysApply: false
---

# Gestão de Códigos (TECHNICAL_SCOPE 60-66)

## Requisitos obrigatórios

1. **Lista completa paginada (50 itens por página)**
   - Backend: `GET /api/admin/codes?page=1` com `limit = 50` (API_DEFAULTS.CODES_PAGE_SIZE).
   - Resposta: `{ codes, total, page, totalPages }`.
   - UI: exibir "Página X de Y" e "50 itens por página"; botões Anterior/Próxima.

2. **Busca por código ou endereço IP**
   - Backend: mesmo endpoint com `?search=termo`; filtrar com `code LIKE %termo% OR ip_address LIKE %termo%`.
   - UI: campo de busca com placeholder "Buscar por código ou IP..."; submit recarrega lista (página 1).

3. **Visualização de status (disponível / resgatado)**
   - Coluna Status na tabela: "Disponível" (ex.: badge azul) quando `is_used === false`, "Resgatado" (ex.: badge verde) quando `is_used === true`.
   - Exibir também: Código promocional, Link, Data de resgate, IP do resgate.

4. **Exportação de resgates em CSV**
   - Backend: `GET /api/admin/export-redeemed` retorna CSV com cabeçalho (ex.: codigo,link,data,ip) e Content-Disposition: attachment; filename=resgates.csv.
   - UI: link ou botão "Exportar Resgatados" que aciona o download (href ou window.location para o endpoint).

## Contratos

- Não alterar o tamanho de página (50) sem atualizar API_DEFAULTS.CODES_PAGE_SIZE no backend e API_DEFAULTS no frontend.
- Busca deve zerar para página 1 ao submeter.
- Exportação inclui apenas códigos já resgatados (is_used = 1).
